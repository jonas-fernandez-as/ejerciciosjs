<!DOCTYPE html>
<html lang="es">
<head>
 <meta charset="UTF-8">
 <meta http-equiv="X-UA-Compatible" content="IE=edge">
 <meta name="viewport" content="width=device-width, initial-scale=1.0">
 <title>Asincronia en javascript</title>
</head>
<body>
 <h1>Asincronia en javascript</h1>

 <script>
 /*
  console.log("Inicio")
  setTimeout(() => {
   console.log(`Ejecutando un set time out,
   esto se ejecuta una sola vez`)
  }, 1000);

  
  setInterval(() => {
   console.log(`Ejecutando un setInterval,
   esto se ejecuta indefinidamente cada cierto 
   intervalo de tiempo`)
  }, 1000);
 */
/*
 let temporizador= setTimeout(() => {
  console.log(new Date().toLocaleTimeString())
 }, 1000);

clearTimeout(temporizador)
console.log("Despues del clear")
*/
/*
 let temporizador=setInterval(() => {
  console.log(new Date().toLocaleTimeString())
 }, 1000);

clearInterval(temporizador)
 console.log("Despues del clearInterval")
*/

//************************************************************************








//Asincronia y Event Loop








/*Antes de explicar como funciona el modelo
de JavaScript es importante entender algunos conceptos:

Procesamiento Single thread y multi thread
Operaciones de CPU y Operaciones de I/O
Operaciones Concurrentes y paralelas
Operaciones BLoqueantes y No Bloqueantes
Operaciones Sincronas y Asincronas  

Javascript usa un modelo asincrono y no bloqueante,
con un loop de eventos implementado en un solo hilo,
(single thread) para operaciones de entrada y salida
(input/output)
*/

/*Codigo Sincrono BLoqueante*/

/*
(()=>{
console.log("Codigo Sincrono")
Console.log("Inicio")

function dos(){
 console.log("Dos");
}
function uno (){
 console.log("Uno")
 dos();
 console.log("Tres")
}
uno();

console.log("FIn")
})();

console.log("******************")
/*Codigo asincrono no BLoqueante*/
/*
(()=>{
console.log("Codigo Sincrono")
Console.log("Inicio")

function dos(){
setTimeout(() => {
 console.log("Dos");
}, 1000);
}
function uno (){
setTimeout(() => {
 console.log("Uno");
},0);
 dos();
 console.log("Tres")
}
uno();

console.log("FIn")
})();
*/
//************************************************************************





//Callbacks








//Una callback es una funcion que se va a ejecutar
//despues de que otra lo haga

/*
function cuadradoCallback(value,callback){
 setTimeout(()=>{
   callback(value,value*value)
 },0|Math.random()*1000);
}

 cuadradoCallback(0, (value, result) => {
  console.log("Inicia Callback");
  console.log(`Callback: ${value},${result}`)
  cuadradoCallback(1, (value, result) => {
   console.log(`Callback: ${value},${result}`)
   cuadradoCallback(2, (value, result) => {
    console.log(`Callback: ${value},${result}`)
    cuadradoCallback(3, (value, result) => {
     console.log(`Callback: ${value},${result}`)
     cuadradoCallback(4, (value, result) => {
      console.log(`Callback: ${value},${result}`)
      cuadradoCallback(5, (value, result) => {
       console.log(`Callback: ${value},${result}`)
       cuadradoCallback(6, (value, result) => {
        console.log(`Callback: ${value},${result}`)
       });
      });
     });
    });
   });
  });
 });
 */

//********************************************




//PROMISES






/*
function cuadradoPromise(value){
 if(typeof value !== "number"){ return Promise.reject
 (`Error, el valor "${value}" ingresado no es un número`);
 }
 return new Promise((resolve,reject)=>{

  setTimeout(()=>{
   resolve({
    value,
    result:value*value
   });
  },0|Math.random()*1000);
 });
}


cuadradoPromise(0)
.then((obj)=>{
 console.log("Inicio Promise")
 console.log(`Promise: ${obj.value}, ${obj.result}`);
 return cuadradoPromise(1)
})
.then(obj=>{
 console.log(`Promise: ${obj.value}, ${obj.result}`);
 return cuadradoPromise(2)
})
.then(obj=>{
 console.log(`Promise: ${obj.value}, ${obj.result}`);
 return cuadradoPromise(3)
})
.then(obj=>{
 console.log(`Promise: ${obj.value}, ${obj.result}`);
 return cuadradoPromise(4)
})
.then(obj=>{
 console.log(`Promise: ${obj.value}, ${obj.result}`);
 return cuadradoPromise(5)
})
.then(obj=>{
 console.log(`Promise: ${obj.value}, ${obj.result}`);
 console.log(`Fin Promise`)
})

.catch(err=> console.error(err));
*/

//********************************************





//ASYNC-AWAIT


/*
function cuadradoPromise(value){
 if(typeof value !== "number"){ return Promise.reject
 (`Error, el valor "${value}" ingresado no es un número`);
 }
 return new Promise((resolve,reject)=>{

  setTimeout(()=>{
   resolve({
    value,
    result:value*value
   });
  },0|Math.random()*1000);
 });
}

async function funcionAsincronaDeclarada(){
try{
console.log("Inicio de Async Function")
let obj=await cuadradoPromise(0)
console.log(`Async Function: ${obj.value}, ${obj.result}`)

obj=await cuadradoPromise(1)
console.log(`Async Function: ${obj.value}, ${obj.result}`)

obj=await cuadradoPromise(2)
console.log(`Async Function: ${obj.value}, ${obj.result}`)

obj=await cuadradoPromise(3)
console.log(`Async Function: ${obj.value}, ${obj.result}`)

obj=await cuadradoPromise(4)
console.log(`Async Function: ${obj.value}, ${obj.result}`)

obj=await cuadradoPromise(5)
console.log(`Async Function: ${obj.value}, ${obj.result}`)

console.log("Fin Async Function")
}catch(err){
 console.error(err)
}

}


funcionAsincronaDeclarada()


const funcionAsincronaExpresada =async () =>{

 try{
console.log("Inicio de Async Function")
let obj=await cuadradoPromise(6)
console.log(`Async Function: ${obj.value}, ${obj.result}`)

obj=await cuadradoPromise(7)
console.log(`Async Function: ${obj.value}, ${obj.result}`)

obj=await cuadradoPromise(8)
console.log(`Async Function: ${obj.value}, ${obj.result}`)

obj=await cuadradoPromise(9)
console.log(`Async Function: ${obj.value}, ${obj.result}`)

obj=await cuadradoPromise(10)
console.log(`Async Function: ${obj.value}, ${obj.result}`)

obj=await cuadradoPromise(11)
console.log(`Async Function: ${obj.value}, ${obj.result}`)

console.log("Fin Async Function")
}catch(err){
 console.error(err)
}

}
*/

 </script>
</body>
</html>